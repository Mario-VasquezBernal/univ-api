generator client {
  provider = "prisma-client-js"
  output   = "../../node_modules/@prisma/client-carreras"
}

datasource db {
  provider = "postgresql"
}

model Carrera {
  id        Int       @id @default(autoincrement())
  nombre    String
  codigo    String    @unique
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  alumnos   Alumno[]
  materias  Materia[]

  @@map("carreras")
}

model Ciclo {
  id        Int       @id @default(autoincrement())
  nombre    String
  numero    Int       @unique
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  materias  Materia[]

  @@map("ciclos")
}

model Materia {
  id        Int      @id @default(autoincrement())
  nombre    String
  codigo    String   @unique
  cicloId   Int
  carreraId Int
  creditos  Int      @default(4)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  cursos    Curso[]
  carrera   Carrera  @relation(fields: [carreraId], references: [id])
  ciclo     Ciclo    @relation(fields: [cicloId], references: [id])

  @@map("materias")
}

model Curso {
  id         Int         @id @default(autoincrement())
  materiaId  Int
  profesorId Int
  seccion    String
  turno      Turno
  cupo       Int         @default(40)
  activo     Boolean     @default(true)
  createdAt  DateTime    @default(now())
  updatedAt  DateTime    @updatedAt
  materia    Materia     @relation(fields: [materiaId], references: [id])
  horarios   Horario[]
  matriculas Matricula[]

  @@map("cursos")
}

model Horario {
  id         Int      @id @default(autoincrement())
  cursoId    Int
  dia        String
  horaInicio String
  horaFin    String
  aula       String?
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  curso      Curso    @relation(fields: [cursoId], references: [id], onDelete: Cascade)

  @@map("horarios")
}

model Alumno {
  id         Int         @id @default(autoincrement())
  dni        String      @unique
  nombres    String
  apellidos  String
  email      String      @unique
  telefono   String?
  carreraId  Int
  createdAt  DateTime    @default(now())
  updatedAt  DateTime    @updatedAt
  carrera    Carrera     @relation(fields: [carreraId], references: [id])
  matriculas Matricula[]

  @@map("alumnos")
}

model Matricula {
  id        Int      @id @default(autoincrement())
  alumnoId  Int
  cursoId   Int
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  alumno    Alumno   @relation(fields: [alumnoId], references: [id])
  curso     Curso    @relation(fields: [cursoId], references: [id])

  @@unique([alumnoId, cursoId])
  @@map("matriculas")
}

enum Turno {
  MATUTINO
  VESPERTINO
  NOCTURNO
}
